<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<!-- http://linux-ntfs.sourceforge.net/ldm/vblk.html -->

<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
    <meta name="description" content="LDM Logical Disk Manager Documentation">
    <link rel="stylesheet" type="text/css" href="ldm.css">
    <link rel="start" type="text/html" href="index.html" title="LDM Documentation">
    <title>VBLK - LDM Documentation</title>
  </head>

  <body>
    <table border="1" class="toolbar" summary="" cellspacing="0">
      <tr>
        <td class="toolbar"><a accesskey="1" class="toolbar" href="index.html">Home</a></td>
        <td class="toolbar">&nbsp;</td>
        <td class="toolbar"><a accesskey="2" class="toolbar" href="partition.html">Part</a></td>
        <td class="toolbar">&nbsp;</td>
        <td class="toolbar"><a accesskey="3" class="toolbar" href="privhead.html">Priv</a></td>
        <td class="toolbar">&nbsp;</td>
        <td class="toolbar"><a accesskey="4" class="toolbar" href="tocblock.html">TOC</a></td>
        <td class="toolbar">&nbsp;</td>
        <td class="toolbar"><a accesskey="5" class="toolbar" href="vmdb.html">VMDB</a></td>
        <td class="toolbar">&nbsp;</td>
        <td class="toolbar"><a accesskey="6" class="toolbar" href="vblk.html">VBLK</a></td>
        <td class="toolbar">&nbsp;</td>
        <td class="toolbar"><a accesskey="7" class="toolbar" href="klog.html">KLOG</a></td>
      </tr>
    </table>

    <h1>VBLK - LDM Documentation</h1>

    <h2>Overview</h2>

    <p>
    A table size of P implies the field is prefixed by a one byte length marker.
    Unless a string is listed as NULL terminated, it isn't.
    </p>

    <h2>Standard VBLK Header</h2>

    <table border="1" summary="" cellspacing="0">
      <tr>
        <th class="numeric">Offset</th>
        <th class="numeric">Size</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="numeric">0x00</td>
        <td class="numeric">4</td>
        <td>"VBLK" Magic number</td>
      </tr>
      <tr>
        <td class="numeric">0x04</td>
        <td class="numeric">4</td>
        <td>VMDB Sequence number</td>
      </tr>
      <tr>
        <td class="numeric">0x08</td>
        <td class="numeric">4</td>
        <td>Id (unknown)</td>
      </tr>
      <tr>
        <td class="numeric">0x0C</td>
        <td class="numeric">2</td>
        <td>Record Number (x of y)</td>
      </tr>
      <tr>
        <td class="numeric">0x0E</td>
        <td class="numeric">2</td>
        <td>Number of Records</td>
      </tr>
      <tr>
        <td class="numeric">0x10</td>
        <td class="numeric">4</td>
        <td>Record Type (and flags)</td>
      </tr>
      <tr>
        <td class="numeric">0x14</td>
        <td class="numeric">4</td>
        <td>Id (unknown)</td>
      </tr>
    </table>

    <h3>Notes</h3>

    <p>
    The Sequence Numbers start at 4.
    0&nbsp;-&nbsp;3 are effectively the VMDB Header block.
    </p>

    <p>
    The Record Number is usually zero.  If the information won't fit
    into a single VBLK record, then more are used.
    </p>

    <p>
    The Record Type can be 0x32 (Component), 0x33 (Partition),
    0x34 (Disk), 0x35 (Disk Group) or 0x51 (Volume).
    </p>

    <h2>Component (0x32)</h2>

    <table border="1" summary="" cellspacing="0">
      <tr>
        <th class="numeric">Offset</th>
        <th class="numeric">Size</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="numeric">0x00</td>
        <td class="numeric">24</td>
        <td>Standard VBLK Header</td>
      </tr>
      <tr>
        <td class="numeric">0x18</td>
        <td class="numeric">P</td>
        <td>Object Id</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Name (string)</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Volume State</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">1</td>
        <td>Flag?</td>
      </tr>
      <tr>
        <td class="numeric">..0x19</td>
        <td class="numeric">4</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x1D</td>
        <td class="numeric">2</td>
        <td>Flags?</td>
      </tr>
      <tr>
        <td class="numeric">..0x1F</td>
        <td class="numeric">6</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x25</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x27</td>
        <td class="numeric">8</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x2F</td>
        <td class="numeric">P</td>
        <td>Parent Id (A Volume)</td>
      </tr>
      <tr>
        <td class="numeric">..0x2F</td>
        <td class="numeric">1</td>
        <td>Zero</td>
      </tr>
      <tr>
        <td class="numeric">..0x30</td>
        <td class="numeric">4</td>
        <td>Flags</td>
      </tr>
    </table>

    <pre>
    Volume State = ACTIVE
    </pre>

    <h2>Disk (0x34)</h2>

    <table border="1" summary="" cellspacing="0">
      <tr>
        <th class="numeric">Offset</th>
        <th class="numeric">Size</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="numeric">0x00</td>
        <td class="numeric">24</td>
        <td>Standard VBLK Header</td>
      </tr>
      <tr>
        <td class="numeric">0x18</td>
        <td class="numeric">P</td>
        <td>Object Id</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Name (string)</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Disk Id (GUID, string)</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">11</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x23</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
    </table>

    <pre>
    AltName
    </pre>

    <h2>Disk Group (0x35)</h2>

    <table border="1" summary="" cellspacing="0">
      <tr>
        <th class="numeric">Offset</th>
        <th class="numeric">Size</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="numeric">0x00</td>
        <td class="numeric">24</td>
        <td>Standard VBLK Header</td>
      </tr>
      <tr>
        <td class="numeric">0x18</td>
        <td class="numeric">P</td>
        <td>Object Id</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Name (string)</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Disk Id (GUID, string)</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">11</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x23</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
    </table>

    <h2>Partition (0x33)</h2>

    <table border="1" summary="" cellspacing="0">
      <tr>
        <th class="numeric">Offset</th>
        <th class="numeric">Size</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="numeric">0x00</td>
        <td class="numeric">24</td>
        <td>Standard VBLK Header</td>
      </tr>
      <tr>
        <td class="numeric">0x18</td>
        <td class="numeric">P</td>
        <td>Object Id</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Name (string)</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">10</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x22</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x24</td>
        <td class="numeric">8</td>
        <td>Start</td>
      </tr>
      <tr>
        <td class="numeric">..0x2C</td>
        <td class="numeric">8</td>
        <td>Volume Offset</td>
      </tr>
      <tr>
        <td class="numeric">..0x34</td>
        <td class="numeric">P</td>
        <td>Size</td>
      </tr>
      <tr>
        <td class="numeric">..0x34</td>
        <td class="numeric">P</td>
        <td>Parent Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x34</td>
        <td class="numeric">P</td>
        <td>Disk Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x34</td>
        <td class="numeric">2</td>
        <td>Flags? Sequence?</td>
      </tr>
    </table>

    <h2>Volume (0x51)</h2>

    <table border="1" summary="" cellspacing="0">
      <tr>
        <th class="numeric">Offset</th>
        <th class="numeric">Size</th>
        <th>Description</th>
      </tr>
      <tr>
        <td class="numeric">0x00</td>
        <td class="numeric">24</td>
        <td>Standard VBLK Header</td>
      </tr>
      <tr>
        <td class="numeric">0x18</td>
        <td class="numeric">P</td>
        <td>Object Id</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Name</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">P</td>
        <td>Volume Type</td>
      </tr>
      <tr>
        <td class="numeric">..0x18</td>
        <td class="numeric">1</td>
        <td>Zero</td>
      </tr>
      <tr>
        <td class="numeric">..0x19</td>
        <td class="numeric">14</td>
        <td>Volume State (string, null padded)</td>
      </tr>
      <tr>
        <td class="numeric">..0x27</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x29</td>
        <td class="numeric">1</td>
        <td>Sequence Number?</td>
      </tr>
      <tr>
        <td class="numeric">..0x2A</td>
        <td class="numeric">3</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x2D</td>
        <td class="numeric">3</td>
        <td>Flags?</td>
      </tr>
      <tr>
        <td class="numeric">..0x30</td>
        <td class="numeric">6</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x36</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x38</td>
        <td class="numeric">6</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x3E</td>
        <td class="numeric">2</td>
        <td>Id?</td>
      </tr>
      <tr>
        <td class="numeric">..0x40</td>
        <td class="numeric">P</td>
        <td>Size</td>
      </tr>
      <tr>
        <td class="numeric">..0x40</td>
        <td class="numeric">4</td>
        <td>Zeros</td>
      </tr>
      <tr>
        <td class="numeric">..0x44</td>
        <td class="numeric">1</td>
        <td>???</td>
      </tr>
      <tr>
        <td class="numeric">..0x45</td>
        <td class="numeric">16</td>
        <td>GUID</td>
      </tr>
      <tr>
        <td class="numeric">..0x55</td>
        <td class="numeric">P</td>
        <td>Drive Hint (string)</td>
      </tr>
    </table>

    <pre>
    Volume Type = gen or raid5
    </pre>

    <pre>
    Volume State = ACTIVE
    </pre>

    <br>
    <!-- The two validators will only work if this page is visible on the web -->
    <a class="contact" href="http://validator.w3.org/check/referer">Validate HTML</a>
    <a class="contact" href="http://jigsaw.w3.org/css-validator/check/referer">Validate CSS</a>
    <a class="contact" href="mailto:webmaster@flatcap.org">
    $Id: vblk.html,v 1.1 2001/05/30 20:25:10 flatcap Exp $
    </a>
  </body>
</html>

